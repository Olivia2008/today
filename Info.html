<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>HUI </title>
<link rel="stylesheet" type="text/css" href="css/hui.css" />
</head>
<body>
<header class="hui-header" id="hui-header">
	<div id="hui-back"></div>
	<h1></h1>
</header>
<div class="hui-wrap">
	<div id="content"></div>	
</div>
<div id="share"><img src="img/icon.png" alt="" /></div>
<script type="text/javascript" src="js/hui.js" charset="UTF-8"></script>
<script type="text/javascript">
	var self, news;
	hui.plusReady(function(){
		self=plus.webview.currentWebview();
		hui.getJSON(
			'http://hoa.hcoder.net/index.php?user=hcoder&pwd=hcoder&m=info&id='+self.newsId,
			function(data){
				news=data;
				hui('#hui-header').find('h1').html(data.title);
				hui('#content').html(data.content);
			},
			function(){
				hui.toast('新闻加载失败');
			}
		);
	});
	//新闻详情分享
	hui('#share').click(function(){
		//H5+
		var actionbuttons=[{title:'微信好友'},{title:'朋友圈'}];
		var actionstyle={title:'请选择分享类型',cancel:'取消',buttons:actionbuttons};
		var wxshare=null;
		plus.nativeUI.actionSheet(actionstyle,function(e){
			//console.log(e.index);//点击不同按钮得到的值
			//如果有微信分享的功能 
			if(e.index>0){
				//h5+
				plus.share.getServices(
					function(s){
						for(var i in s){
							if(s[i].id=='weixin'){wxshare=s[i];}
							//console.log(JSON.stringify(s[i]));
						}
						//如果安装了微信
						if(wxshare){
							//微信好友
							if(e.index==1){
								var msg={'title':news.title,content:'你关心的，才是头条',href:'http://www.toutiao.com',thumbs:['_www/img/share.png'],extra:{scene:'WXSceneSession'}};
							}else{//微信朋友圈
									var msg={'title':news.title, content:'你关心的，才是头条',href:'http://www.toutiao.com',thumbs:['_www/img/share.png'],extra:{scene:'WXSceneTimeline'}};
							}	
						}
						wxshare.send(
							msg,
							function(){hui.toast('分享成功！');},
							function(e){hui.toast('分享失败或取消');}
						);
						//console.log(JSON.stringify(wxshare));
					},
					function(){
						hui.toast('您还没有安装微信')
					})
			}
		});
	});
	
</script>
</body>
</html>